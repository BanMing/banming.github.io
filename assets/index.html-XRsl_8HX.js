import{_ as i}from"./ComputerNetworkStructure-BnciuTvA.js";import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{e,f as l,o as n}from"./app-NW-ua5u5.js";const o="/assets/IPDatagramFormat-BzHymcJa.png",s="/assets/ICMPDatagramFormat-CNbDBcS5.png",r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgsAAAB/CAMAAABWrXECAAAAe1BMVEX///8yMjLs7OxFRUXu7u7S0tJQUFA+Pj719fVfX19cXFz6+vr8/PxhYWFYWFj4+PhlZWXj4+M6Ojo3Nzfp6elzc3PExMR+fn7Y2NicnJxJSUnKysry8vK1tbXPz8+NjY3d3d2vr6+hoaGEhIRpaWm6urqpqalsbGyVlZUKEtDBAAAD9klEQVR42uzZ6Y6iQBiF4UNVUew7iOK+tHr/VziFOjOtbXdiMkRgzpM0wg9Dvsqbwg4gIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIi+k8pQaOl8JLYotHy8BLLku9jbk7dsaxXW8C/NKCbjx9bILZAbIHYArEFYgvEFogtEFsgtkBgC3T19uVlC+PFFogtEFsgtkBsgdgCsQViC8QWiC0QRtBC4MJYBDBCd2wthCFEe8hwkeDmybQB4KI/OmlBXAFwlRAqCISxwG+rOgHcegqjnP3+gjugFn4aMJvCwapUeYDWEupKfJk2nCSYCfRGJy1I6VhSSkDMokb6U9tc6TpDK1Gq1FshZnGm1EKJuFQKltbOekAt/DTgMg2dILUnMS4caC9qOXicdtWU2J8D9EVHzwjbSsxReCc7cFeZbblhdjihNYlbudaxsY/9yI8j5AjrjwG18NOA4jB1JnWwr5UQrhKO0JlqOXiYVsRboGzmIXqi0xb2UXC7ck0ExW3odr/MN8oAZh9YnoEcGx0MsIVnA0aetmJv4sS+lMtIW1pHaRqnqXyYVlU1jA9tJ+iHLltI8gn+LFWwlLjSnudLz9BQdir8lQpy1Lth/Xb8fkDXropZuStKnNfXZ4QCamB9P62oTi5ax2bbkx+QXbawscTvq6yc+ztcFeqmgKnCbzzPzsPDOhleC88GTM7VtJmczqcJqiUQOKp9Rjhm3OBu2vqQiauPZode6LKF6d+lkjLa4qaIbgpAtYAcbnocXgtPB9yK/VZl4XbvyhJiVRxy3/MKzzRwN20217potDlk5X+wLyyKT1voX8Wnk8asUdOuDux4eC08HdDTMvK1EnKWIvDqPJPhZV9YfJk2lJk5mmJ6ossWUB0WIZCEDy2omwJwcPnLg0A4w2vh6YBK2+7cC1Fbl1CcUEKnMo1OX6bdyBDmqie7QsctZLpaldly89BCevOphfl8lg6whWcDlvvoqOdQlbN12+myGM4lkcdp3XqNdm8Z+/+UUxnAKNex1FU2ld/uC+ajXZ1ZWk0H1cL3Ay7KtdZHUVcTuXPD0NnWlykzfT9tYL6qRCmOMfriDe8jHP/GMefXDzme9xHu3j+rzbGqXcz1cjNtquVlJ4z0/bSruCpxlDKeoC/e0MLu00m7EHPgYzwtYJLAsGGUwUHvZgoagIrup01stHrzgOA7a2ILxBaILRBbILZAbIHYArEFYgsEvH152cJ4sQViC8QWiC0QWyC2QGyB2AKxBWILBLZAV29fXssS72NuTt15tYXCotEq8JJK0mhVICIiIiIiIiIiIiIiIiIiIiIiIiIiIiIi+tUeHAgAAAAACPK3XmGACgAAAACAIUKvTe/EmGWzAAAAAElFTkSuQmCC",d="/assets/TCPHead-513hIujY.png",p="data:image/png;base64,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",c="/assets/UDPHead-Da9julxt.png",h="/assets/FlowControl-Ck-hR0yc.png",g="/assets/cwnd-D10u8hXW.png",P="/assets/FastRetransmissionDiagram-C0JItbWU.png",u="/assets/TCPCongestionControlFlowchart-Byd0n0B1.png",C="/assets/20210417162838-qndNCqhE.svg",A="/assets/TCPConnection-DifpUyKR.png",f="/assets/20210417162839-DYLO0Aw1.svg",b="/assets/TCPDisconnection-DORXjzbH.png",I="/assets/20210417162840-Bpqhv8zB.svg",T="/assets/TCPFSM-EhHT7zP2.png",m="/assets/socket_trans-Dhg8YONi.jpg",k="/assets/201012122157467258-B2PtEo2r.png",S="/assets/201012122157487616-CWPTpxvC.png",D={};function x(U,t){return n(),e("div",null,t[0]||(t[0]=[l('<h1 id="计算机网络" tabindex="-1"><a class="header-anchor" href="#计算机网络"><span>计算机网络</span></a></h1><blockquote><p>本节部分知识点来自《计算机网络（第 7 版）》</p></blockquote><p>计算机网络体系结构：</p><figure><img src="'+i+'" alt="计算机网络体系结构" tabindex="0" loading="lazy"><figcaption>计算机网络体系结构</figcaption></figure><h2 id="各层作用及协议" tabindex="-1"><a class="header-anchor" href="#各层作用及协议"><span>各层作用及协议</span></a></h2><table><thead><tr><th>分层</th><th>作用</th><th>协议</th></tr></thead><tbody><tr><td>物理层</td><td>通过媒介传输比特，确定机械及电气规范（比特 Bit）</td><td>RJ45、CLOCK、IEEE802.3（中继器，集线器）</td></tr><tr><td>数据链路层</td><td>将比特组装成帧和点到点的传递（帧 Frame）</td><td>PPP、FR、HDLC、VLAN、MAC（网桥，交换机）</td></tr><tr><td>网络层</td><td>负责数据包从源到宿的传递和网际互连（包 Packet）</td><td>IP、ICMP、ARP、RARP、OSPF、IPX、RIP、IGRP（路由器）</td></tr><tr><td>运输层</td><td>提供端到端的可靠报文传递和错误恢复（ 段Segment）</td><td>TCP、UDP、SPX</td></tr><tr><td>会话层</td><td>建立、管理和终止会话（会话协议数据单元 SPDU）</td><td>NFS、SQL、NETBIOS、RPC</td></tr><tr><td>表示层</td><td>对数据进行翻译、加密和压缩（表示协议数据单元 PPDU）</td><td>JPEG、MPEG、ASII</td></tr><tr><td>应用层</td><td>允许访问OSI环境的手段（应用协议数据单元 APDU）</td><td>FTP、DNS、Telnet、SMTP、HTTP、WWW、NFS</td></tr></tbody></table><h2 id="物理层" tabindex="-1"><a class="header-anchor" href="#物理层"><span>物理层</span></a></h2><ul><li>传输数据的单位：比特</li><li>数据传输系统：源系统（源点、发送器） --&gt; 传输系统 --&gt; 目的系统（接收器、终点）</li></ul><p>通道：</p><ul><li>单向通道（单工通道）：只有一个方向通信，没有反方向交互，如广播</li><li>双向交替通信（半双工通信）：通信双方都可发消息，但不能同时发送或接收</li><li>双向同时通信（全双工通信）：通信双方可以同时发送和接收信息</li></ul><p>通道复用技术：</p><ul><li>频分复用（FDM，Frequency Division Multiplexing）：不同用户在不同频带，所用用户在同样时间占用不同带宽资源</li><li>时分复用（TDM，Time Division Multiplexing）：不同用户在同一时间段的不同时间片，所有用户在不同时间占用同样的频带宽度</li><li>波分复用（WDM，Wavelength Division Multiplexing）：光的频分复用</li><li>码分复用（CDM，Code Division Multiplexing）：不同用户使用不同的码，可以在同样时间使用同样频带通信</li></ul><h2 id="数据链路层" tabindex="-1"><a class="header-anchor" href="#数据链路层"><span>数据链路层</span></a></h2><p>主要信道：</p><ul><li>点对点信道</li><li>广播信道</li></ul><h3 id="点对点信道" tabindex="-1"><a class="header-anchor" href="#点对点信道"><span>点对点信道</span></a></h3><ul><li>数据单元：帧</li></ul><p>三个基本问题：</p><ul><li>封装成帧：把网络层的 IP 数据报封装成帧，<code>SOH - 数据部分 - EOT</code></li><li>透明传输：不管数据部分什么字符，都能传输出去；可以通过字节填充方法解决（冲突字符前加转义字符）</li><li>差错检测：降低误码率（BER，Bit Error Rate），广泛使用循环冗余检测（CRC，Cyclic Redundancy Check）</li></ul><p>点对点协议（Point-to-Point Protocol）：</p><ul><li>点对点协议（Point-to-Point Protocol）：用户计算机和 ISP 通信时所使用的协议</li></ul><h3 id="广播信道" tabindex="-1"><a class="header-anchor" href="#广播信道"><span>广播信道</span></a></h3><p>广播通信：</p><ul><li>硬件地址（物理地址、MAC 地址）</li><li>单播（unicast）帧（一对一）：收到的帧的 MAC 地址与本站的硬件地址相同</li><li>广播（broadcast）帧（一对全体）：发送给本局域网上所有站点的帧</li><li>多播（multicast）帧（一对多）：发送给本局域网上一部分站点的帧</li></ul><h2 id="网络层" tabindex="-1"><a class="header-anchor" href="#网络层"><span>网络层</span></a></h2><ul><li>IP（Internet Protocol，网际协议）是为计算机网络相互连接进行通信而设计的协议。</li><li>ARP（Address Resolution Protocol，地址解析协议）</li><li>ICMP（Internet Control Message Protocol，网际控制报文协议）</li><li>IGMP（Internet Group Management Protocol，网际组管理协议）</li></ul><h3 id="ip-网际协议" tabindex="-1"><a class="header-anchor" href="#ip-网际协议"><span>IP 网际协议</span></a></h3><p>IP 地址分类：</p><ul><li><code>IP 地址 ::= {&lt;网络号&gt;,&lt;主机号&gt;}</code></li></ul><table><thead><tr><th>IP 地址类别</th><th>网络号</th><th>网络范围</th><th>主机号</th><th>IP 地址范围</th></tr></thead><tbody><tr><td>A 类</td><td>8bit，第一位固定为 0</td><td>0 — 127</td><td>24bit</td><td>1.0.0.0 — 127.255.255.255</td></tr><tr><td>B 类</td><td>16bit，前两位固定为 10</td><td>128.0 — 191.255</td><td>16bit</td><td>128.0.0.0 — 191.255.255.255</td></tr><tr><td>C 类</td><td>24bit，前三位固定为 110</td><td>192.0.0 — 223.255.255</td><td>8bit</td><td>192.0.0.0 — 223.255.255.255</td></tr><tr><td>D 类</td><td>前四位固定为 1110，后面为多播地址</td><td></td><td></td><td></td></tr><tr><td>E 类</td><td>前五位固定为 11110，后面保留为今后所用</td><td></td><td></td><td></td></tr></tbody></table><p>IP 数据报格式：</p><figure><img src="'+o+'" alt="IP 数据报格式" tabindex="0" loading="lazy"><figcaption>IP 数据报格式</figcaption></figure><h3 id="icmp-网际控制报文协议" tabindex="-1"><a class="header-anchor" href="#icmp-网际控制报文协议"><span>ICMP 网际控制报文协议</span></a></h3><p>ICMP 报文格式：</p><figure><img src="'+s+'" alt="ICMP 报文格式" tabindex="0" loading="lazy"><figcaption>ICMP 报文格式</figcaption></figure><p>应用：</p><ul><li>PING（Packet InterNet Groper，分组网间探测）测试两个主机之间的连通性</li><li>TTL（Time To Live，生存时间）该字段指定 IP 包被路由器丢弃之前允许通过的最大网段数量</li></ul><h3 id="内部网关协议" tabindex="-1"><a class="header-anchor" href="#内部网关协议"><span>内部网关协议</span></a></h3><ul><li>RIP（Routing Information Protocol，路由信息协议）</li><li>OSPF（Open Sortest Path First，开放最短路径优先）</li></ul><h3 id="外部网关协议" tabindex="-1"><a class="header-anchor" href="#外部网关协议"><span>外部网关协议</span></a></h3><ul><li>BGP（Border Gateway Protocol，边界网关协议）</li></ul><h3 id="ip多播" tabindex="-1"><a class="header-anchor" href="#ip多播"><span>IP多播</span></a></h3><ul><li>IGMP（Internet Group Management Protocol，网际组管理协议）</li><li>多播路由选择协议</li></ul><h3 id="vpn-和-nat" tabindex="-1"><a class="header-anchor" href="#vpn-和-nat"><span>VPN 和 NAT</span></a></h3><ul><li>VPN（Virtual Private Network，虚拟专用网）</li><li>NAT（Network Address Translation，网络地址转换）</li></ul><h3 id="路由表包含什么" tabindex="-1"><a class="header-anchor" href="#路由表包含什么"><span>路由表包含什么？</span></a></h3><ol><li>网络 ID（Network ID, Network number）：就是目标地址的网络 ID。</li><li>子网掩码（subnet mask）：用来判断 IP 所属网络</li><li>下一跳地址/接口（Next hop / interface）：就是数据在发送到目标地址的旅途中下一站的地址。其中 interface 指向 next hop（即为下一个 route）。一个自治系统（AS, Autonomous system）中的 route 应该包含区域内所有的子网络，而默认网关（Network id: <code>0.0.0.0</code>, Netmask: <code>0.0.0.0</code>）指向自治系统的出口。</li></ol><p>根据应用和执行的不同，路由表可能含有如下附加信息：</p><ol><li>花费（Cost）：就是数据发送过程中通过路径所需要的花费。</li><li>路由的服务质量</li><li>路由中需要过滤的出/入连接列表</li></ol><h2 id="运输层" tabindex="-1"><a class="header-anchor" href="#运输层"><span>运输层</span></a></h2><p>协议：</p><ul><li>TCP（Transmission Control Protocol，传输控制协议）</li><li>UDP（User Datagram Protocol，用户数据报协议）</li></ul><p>端口：</p><table><thead><tr><th>应用程序</th><th>FTP</th><th>TELNET</th><th>SMTP</th><th>DNS</th><th>TFTP</th><th>HTTP</th><th>HTTPS</th><th>SNMP</th></tr></thead><tbody><tr><td>端口号</td><td>21</td><td>23</td><td>25</td><td>53</td><td>69</td><td>80</td><td>443</td><td>161</td></tr></tbody></table><h3 id="tcp" tabindex="-1"><a class="header-anchor" href="#tcp"><span>TCP</span></a></h3><ul><li>TCP（Transmission Control Protocol，传输控制协议）是一种面向连接的、可靠的、基于字节流的传输层通信协议，其传输的单位是报文段。</li></ul><p>特征：</p><ul><li>面向连接</li><li>只能点对点（一对一）通信</li><li>可靠交互</li><li>全双工通信</li><li>面向字节流</li></ul><p>TCP 如何保证可靠传输：</p><ul><li>确认和超时重传</li><li>数据合理分片和排序</li><li>流量控制</li><li>拥塞控制</li><li>数据校验</li></ul><p>TCP 报文结构</p><figure><img src="'+r+'" alt="TCP 报文" tabindex="0" loading="lazy"><figcaption>TCP 报文</figcaption></figure><p>TCP 首部</p><figure><img src="'+d+'" alt="TCP 首部" tabindex="0" loading="lazy"><figcaption>TCP 首部</figcaption></figure><p>TCP：状态控制码（Code，Control Flag），占 6 比特，含义如下：</p><ul><li>URG：紧急比特（urgent），当 <code>URG＝1</code> 时，表明紧急指针字段有效，代表该封包为紧急封包。它告诉系统此报文段中有紧急数据，应尽快传送(相当于高优先级的数据)， 且上图中的 Urgent Pointer 字段也会被启用。</li><li>ACK：确认比特（Acknowledge）。只有当 <code>ACK＝1</code> 时确认号字段才有效，代表这个封包为确认封包。当 <code>ACK＝0</code> 时，确认号无效。</li><li>PSH：（Push function）若为 1 时，代表要求对方立即传送缓冲区内的其他对应封包，而无需等缓冲满了才送。</li><li>RST：复位比特(Reset)，当 <code>RST＝1</code> 时，表明 TCP 连接中出现严重差错（如由于主机崩溃或其他原因），必须释放连接，然后再重新建立运输连接。</li><li>SYN：同步比特(Synchronous)，SYN 置为 1，就表示这是一个连接请求或连接接受报文，通常带有 SYN 标志的封包表示『主动』要连接到对方的意思。</li><li>FIN：终止比特(Final)，用来释放一个连接。当 <code>FIN＝1</code> 时，表明此报文段的发送端的数据已发送完毕，并要求释放运输连接。</li></ul><h3 id="udp" tabindex="-1"><a class="header-anchor" href="#udp"><span>UDP</span></a></h3><ul><li>UDP（User Datagram Protocol，用户数据报协议）是 OSI（Open System Interconnection 开放式系统互联） 参考模型中一种无连接的传输层协议，提供面向事务的简单不可靠信息传送服务，其传输的单位是用户数据报。</li></ul><p>特征：</p><ul><li>无连接</li><li>尽最大努力交付</li><li>面向报文</li><li>没有拥塞控制</li><li>支持一对一、一对多、多对一、多对多的交互通信</li><li>首部开销小</li></ul><p>包大小：</p><ul><li>在局域网环境下，UDP的数据最大为1472字节。</li><li>网络上的标准MTU为576，所以在网络上的UDP数据包最好是576 - 20 - 8 =548字节内。</li></ul><p>因为在IP层组包时会发生错误，那么包就会被丢弃，所以UDP包在应用层一定要注意大小。</p><p>UDP 报文结构</p><figure><img src="'+p+'" alt="UDP 报文" tabindex="0" loading="lazy"><figcaption>UDP 报文</figcaption></figure><p>UDP 首部</p><figure><img src="'+c+'" alt="UDP 首部" tabindex="0" loading="lazy"><figcaption>UDP 首部</figcaption></figure><blockquote><p>TCP/UDP 图片来源于：<a href="https://github.com/JerryC8080/understand-tcp-udp" target="_blank" rel="noopener noreferrer">https://github.com/JerryC8080/understand-tcp-udp</a></p></blockquote><h3 id="tcp-与-udp-的区别" tabindex="-1"><a class="header-anchor" href="#tcp-与-udp-的区别"><span>TCP 与 UDP 的区别</span></a></h3><ol><li>TCP 面向连接，UDP 是无连接的；</li><li>TCP 提供可靠的服务，也就是说，通过 TCP 连接传送的数据，无差错，不丢失，不重复，且按序到达；UDP 尽最大努力交付，即不保证可靠交付</li><li>TCP 的逻辑通信信道是全双工的可靠信道；UDP 则是不可靠信道</li><li>每一条 TCP 连接只能是点到点的；UDP 支持一对一，一对多，多对一和多对多的交互通信</li><li>TCP 面向字节流（可能出现黏包问题），实际上是 TCP 把数据看成一连串无结构的字节流；UDP 是面向报文的（不会出现黏包问题）</li><li>UDP 没有拥塞控制，因此网络出现拥塞不会使源主机的发送速率降低（对实时应用很有用，如 IP 电话，实时视频会议等）</li><li>TCP 首部开销20字节；UDP 的首部开销小，只有 8 个字节</li><li>UPD 有发送包的大小限制</li></ol><h3 id="tcp-黏包问题" tabindex="-1"><a class="header-anchor" href="#tcp-黏包问题"><span>TCP 黏包问题</span></a></h3><h4 id="原因" tabindex="-1"><a class="header-anchor" href="#原因"><span>原因</span></a></h4><p>TCP 是一个基于字节流的传输服务（UDP 基于报文的），“流” 意味着 TCP 所传输的数据是没有边界的。所以可能会出现两个数据包黏在一起的情况。</p><h4 id="解决" tabindex="-1"><a class="header-anchor" href="#解决"><span>解决</span></a></h4><ul><li>发送定长包。如果每个消息的大小都是一样的，那么在接收对等方只要累计接收数据，直到数据等于一个定长的数值就将它作为一个消息。</li><li>包头加上包体长度。包头是定长的 4 个字节，说明了包体的长度。接收对等方先接收包头长度，依据包头长度来接收包体。</li><li>在数据包之间设置边界，如添加特殊符号 <code>\\r\\n</code> 标记。FTP 协议正是这么做的。但问题在于如果数据正文中也含有 <code>\\r\\n</code>，则会误判为消息的边界。</li><li>使用更加复杂的应用层协议。</li></ul><h3 id="tcp-流量控制" tabindex="-1"><a class="header-anchor" href="#tcp-流量控制"><span>TCP 流量控制</span></a></h3><h4 id="概念" tabindex="-1"><a class="header-anchor" href="#概念"><span>概念</span></a></h4><p>流量控制（flow control）就是让发送方的发送速率不要太快，要让接收方来得及接收。</p><h4 id="方法" tabindex="-1"><a class="header-anchor" href="#方法"><span>方法</span></a></h4><p>利用可变窗口进行流量控制</p><figure><img src="'+h+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>简单地说接收方有一个缓存池子，它只能缓存一定量的没有处理的数据，发多了让发送端等等再发。</p><h3 id="tcp-拥塞控制" tabindex="-1"><a class="header-anchor" href="#tcp-拥塞控制"><span>TCP 拥塞控制</span></a></h3><h4 id="概念-1" tabindex="-1"><a class="header-anchor" href="#概念-1"><span>概念</span></a></h4><p>拥塞控制就是防止过多的数据注入到网络中，这样可以使网络中的路由器或链路不致过载。</p><h4 id="方法-1" tabindex="-1"><a class="header-anchor" href="#方法-1"><span>方法</span></a></h4><ul><li>慢开始( slow-start )</li><li>拥塞避免( congestion avoidance )</li><li>快重传( fast retransmit )</li><li>快恢复( fast recovery )</li></ul><p>TCP的拥塞控制图</p><p><img src="'+g+'" alt="" loading="lazy"><br><img src="'+P+'" alt="" loading="lazy"><br><img src="'+u+'" alt="" loading="lazy"></p><h3 id="tcp-稳定传输" tabindex="-1"><a class="header-anchor" href="#tcp-稳定传输"><span>TCP 稳定传输</span></a></h3><figure><img src="'+C+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="tcp-传输连接管理" tabindex="-1"><a class="header-anchor" href="#tcp-传输连接管理"><span>TCP 传输连接管理</span></a></h3><blockquote><p>因为 TCP 三次握手建立连接、四次挥手释放连接很重要，所以附上《计算机网络（第 7 版）-谢希仁》书中对此章的详细描述：&lt;<a href="https://ftp.bmp.ovh/imgs/2021/04/bc9b8fd6b6bf979f.png" target="_blank" rel="noopener noreferrer">TCP-transport-connection-management</a>&gt;</p></blockquote><h4 id="tcp-三次握手建立连接" tabindex="-1"><a class="header-anchor" href="#tcp-三次握手建立连接"><span>TCP 三次握手建立连接</span></a></h4><figure><img src="'+A+'" alt="TCP三次握手建立连接" tabindex="0" loading="lazy"><figcaption>TCP三次握手建立连接</figcaption></figure><p>【TCP 建立连接全过程解释】</p><ol><li>客户端发送 SYN 给服务器，说明客户端请求建立连接；</li><li>服务端收到客户端发的 SYN，并回复 SYN+ACK 给客户端（同意建立连接）；</li><li>客户端收到服务端的 SYN+ACK 后，回复 ACK 给服务端（表示客户端收到了服务端发的同意报文）；</li><li>服务端收到客户端的 ACK，连接已建立，可以数据传输。</li></ol><p>【数值说明】</p><figure><img src="'+f+'" alt="TCP三次握手建立连接" tabindex="0" loading="lazy"><figcaption>TCP三次握手建立连接</figcaption></figure><h4 id="tcp-为什么要进行三次握手" tabindex="-1"><a class="header-anchor" href="#tcp-为什么要进行三次握手"><span>TCP 为什么要进行三次握手？</span></a></h4><p>【答案一】因为信道不可靠，而 TCP 想在不可靠信道上建立可靠地传输，那么三次通信是理论上的最小值。（而 UDP 则不需建立可靠传输，因此 UDP 不需要三次握手。）</p><blockquote><p><a href="https://groups.google.com/forum/#!msg/pongba/kF6O7-MFxM0/5S7zIJ4yqKUJ" target="_blank" rel="noopener noreferrer">Google Groups . TCP 建立连接为什么是三次握手？{技术}{网络通信}</a></p></blockquote><p>【答案二】因为双方都需要确认对方收到了自己发送的序列号，确认过程最少要进行三次通信。</p><blockquote><p><a href="https://www.zhihu.com/question/24853633/answer/115173386" target="_blank" rel="noopener noreferrer">知乎 . TCP 为什么是三次握手，而不是两次或四次？</a></p></blockquote><p>【答案三】为了防止已失效的连接请求报文段突然又传送到了服务端，因而产生错误。</p><blockquote><p><a href="https://ftp.bmp.ovh/imgs/2021/04/bc9b8fd6b6bf979f.png" target="_blank" rel="noopener noreferrer">《计算机网络（第 7 版）-谢希仁》</a></p></blockquote><h4 id="tcp-四次挥手释放连接" tabindex="-1"><a class="header-anchor" href="#tcp-四次挥手释放连接"><span>TCP 四次挥手释放连接</span></a></h4><figure><img src="'+b+'" alt="TCP四次挥手释放连接" tabindex="0" loading="lazy"><figcaption>TCP四次挥手释放连接</figcaption></figure><p>【TCP 释放连接全过程解释】</p><ol><li>客户端发送 FIN 给服务器，说明客户端不必发送数据给服务器了（请求释放从客户端到服务器的连接）；</li><li>服务器接收到客户端发的 FIN，并回复 ACK 给客户端（同意释放从客户端到服务器的连接）；</li><li>客户端收到服务端回复的 ACK，此时从客户端到服务器的连接已释放（但服务端到客户端的连接还未释放，并且客户端还可以接收数据）；</li><li>服务端继续发送之前没发完的数据给客户端；</li><li>服务端发送 FIN+ACK 给客户端，说明服务端发送完了数据（请求释放从服务端到客户端的连接，就算没收到客户端的回复，过段时间也会自动释放）；</li><li>客户端收到服务端的 FIN+ACK，并回复 ACK 给客户端（同意释放从服务端到客户端的连接）；</li><li>服务端收到客户端的 ACK 后，释放从服务端到客户端的连接。</li></ol><p>【数值说明】</p><figure><img src="'+I+'" alt="TCP三次握手建立连接" tabindex="0" loading="lazy"><figcaption>TCP三次握手建立连接</figcaption></figure><h4 id="tcp-为什么要进行四次挥手" tabindex="-1"><a class="header-anchor" href="#tcp-为什么要进行四次挥手"><span>TCP 为什么要进行四次挥手？</span></a></h4><p>【问题一】TCP 为什么要进行四次挥手？ / 为什么 TCP 建立连接需要三次，而释放连接则需要四次？</p><p>【答案一】因为 TCP 是全双工模式，客户端请求关闭连接后，客户端向服务端的连接关闭（一二次挥手），服务端继续传输之前没传完的数据给客户端（数据传输），服务端向客户端的连接关闭（三四次挥手）。所以 TCP 释放连接时服务器的 ACK 和 FIN 是分开发送的（中间隔着数据传输），而 TCP 建立连接时服务器的 ACK 和 SYN 是一起发送的（第二次握手），所以 TCP 建立连接需要三次，而释放连接则需要四次。</p><p>【问题二】为什么 TCP 连接时可以 ACK 和 SYN 一起发送，而释放时则 ACK 和 FIN 分开发送呢？（ACK 和 FIN 分开是指第二次和第三次挥手）</p><p>【答案二】因为客户端请求释放时，服务器可能还有数据需要传输给客户端，因此服务端要先响应客户端 FIN 请求（服务端发送 ACK），然后数据传输，传输完成后，服务端再提出 FIN 请求（服务端发送 FIN）；而连接时则没有中间的数据传输，因此连接时可以 ACK 和 SYN 一起发送。</p><p>【问题三】为什么客户端释放最后需要 TIME-WAIT 等待 2MSL 呢？</p><p>【答案三】</p><ol><li>为了保证客户端发送的最后一个 ACK 报文能够到达服务端。若未成功到达，则服务端超时重传 FIN+ACK 报文段，客户端再重传 ACK，并重新计时。</li><li>防止已失效的连接请求报文段出现在本连接中。TIME-WAIT 持续 2MSL 可使本连接持续的时间内所产生的所有报文段都从网络中消失，这样可使下次连接中不会出现旧的连接报文段。</li></ol><h3 id="tcp-有限状态机" tabindex="-1"><a class="header-anchor" href="#tcp-有限状态机"><span>TCP 有限状态机</span></a></h3><p>TCP 有限状态机图片</p><figure><img src="'+T+'" alt="TCP 的有限状态机" tabindex="0" loading="lazy"><figcaption>TCP 的有限状态机</figcaption></figure><h2 id="应用层" tabindex="-1"><a class="header-anchor" href="#应用层"><span>应用层</span></a></h2><h3 id="dns" tabindex="-1"><a class="header-anchor" href="#dns"><span>DNS</span></a></h3><ul><li>DNS（Domain Name System，域名系统）是互联网的一项服务。它作为将域名和 IP 地址相互映射的一个分布式数据库，能够使人更方便地访问互联网。DNS 使用 TCP 和 UDP 端口 53。当前，对于每一级域名长度的限制是 63 个字符，域名总长度则不能超过 253 个字符。</li></ul><p>域名：</p><ul><li><code>域名 ::= {&lt;三级域名&gt;.&lt;二级域名&gt;.&lt;顶级域名&gt;}</code>，如：<code>blog.ban-ming.com</code></li></ul><h3 id="ftp" tabindex="-1"><a class="header-anchor" href="#ftp"><span>FTP</span></a></h3><ul><li>FTP（File Transfer Protocol，文件传输协议）是用于在网络上进行文件传输的一套标准协议，使用客户/服务器模式，使用 TCP 数据报，提供交互式访问，双向传输。</li><li>TFTP（Trivial File Transfer Protocol，简单文件传输协议）一个小且易实现的文件传输协议，也使用客户-服务器方式，使用UDP数据报，只支持文件传输而不支持交互，没有列目录，不能对用户进行身份鉴定</li></ul><h3 id="telnet" tabindex="-1"><a class="header-anchor" href="#telnet"><span>TELNET</span></a></h3><ul><li><p>TELNET 协议是 TCP/IP 协议族中的一员，是 Internet 远程登陆服务的标准协议和主要方式。它为用户提供了在本地计算机上完成远程主机工作的能力。</p></li><li><p>HTTP（HyperText Transfer Protocol，超文本传输协议）是用于从 WWW（World Wide Web，万维网）服务器传输超文本到本地浏览器的传送协议。</p></li><li><p>SMTP（Simple Mail Transfer Protocol，简单邮件传输协议）是一组用于由源地址到目的地址传送邮件的规则，由它来控制信件的中转方式。SMTP 协议属于 TCP/IP 协议簇，它帮助每台计算机在发送或中转信件时找到下一个目的地。</p></li><li><p>Socket 建立网络通信连接至少要一对端口号（Socket）。Socket 本质是编程接口（API），对 TCP/IP 的封装，TCP/IP 也要提供可供程序员做网络开发所用的接口，这就是 Socket 编程接口。</p></li></ul><h3 id="www" tabindex="-1"><a class="header-anchor" href="#www"><span>WWW</span></a></h3><ul><li>WWW（World Wide Web，环球信息网，万维网）是一个由许多互相链接的超文本组成的系统，通过互联网访问</li></ul><h4 id="url" tabindex="-1"><a class="header-anchor" href="#url"><span>URL</span></a></h4><ul><li>URL（Uniform Resource Locator，统一资源定位符）是因特网上标准的资源的地址（Address）</li></ul><p>标准格式：</p><ul><li><code>协议类型:[//服务器地址[:端口号]][/资源层级UNIX文件路径]文件名[?查询][#片段ID]</code></li></ul><p>完整格式：</p><ul><li><code>协议类型:[//[访问资源需要的凭证信息@]服务器地址[:端口号]][/资源层级UNIX文件路径]文件名[?查询][#片段ID]</code></li></ul><blockquote><p>其中【访问凭证信息@；:端口号；?查询；#片段ID】都属于选填项<br> 如：<code>http://ban-ming.com/docs/basic/network/#URL</code></p></blockquote><h4 id="http" tabindex="-1"><a class="header-anchor" href="#http"><span>HTTP</span></a></h4><p>HTTP（HyperText Transfer Protocol，超文本传输协议）是一种用于分布式、协作式和超媒体信息系统的应用层协议。HTTP 是万维网的数据通信的基础。</p><p>请求方法</p><table><thead><tr><th>方法</th><th>意义</th></tr></thead><tbody><tr><td>OPTIONS</td><td>请求一些选项信息，允许客户端查看服务器的性能</td></tr><tr><td>GET</td><td>请求指定的页面信息，并返回实体主体</td></tr><tr><td>HEAD</td><td>类似于 get 请求，只不过返回的响应中没有具体的内容，用于获取报头</td></tr><tr><td>POST</td><td>向指定资源提交数据进行处理请求（例如提交表单或者上传文件）。数据被包含在请求体中。POST请求可能会导致新的资源的建立和/或已有资源的修改</td></tr><tr><td>PUT</td><td>从客户端向服务器传送的数据取代指定的文档的内容</td></tr><tr><td>DELETE</td><td>请求服务器删除指定的页面</td></tr><tr><td>TRACE</td><td>回显服务器收到的请求，主要用于测试或诊断</td></tr></tbody></table><p>状态码（Status-Code）</p><ul><li>1xx：表示通知信息，如请求收到了或正在进行处理 <ul><li>100 Continue：继续，客户端应继续其请求</li><li>101 Switching Protocols 切换协议。服务器根据客户端的请求切换协议。只能切换到更高级的协议，例如，切换到 HTTP 的新版本协议</li></ul></li><li>2xx：表示成功，如接收或知道了 <ul><li>200 OK: 请求成功</li></ul></li><li>3xx：表示重定向，如要完成请求还必须采取进一步的行动 <ul><li>301 Moved Permanently: 永久移动。请求的资源已被永久的移动到新 URL，返回信息会包括新的 URL，浏览器会自动定向到新 URL。今后任何新的请求都应使用新的 URL 代替</li></ul></li><li>4xx：表示客户的差错，如请求中有错误的语法或不能完成 <ul><li>400 Bad Request: 客户端请求的语法错误，服务器无法理解</li><li>401 Unauthorized: 请求要求用户的身份认证</li><li>403 Forbidden: 服务器理解请求客户端的请求，但是拒绝执行此请求（权限不够）</li><li>404 Not Found: 服务器无法根据客户端的请求找到资源（网页）。通过此代码，网站设计人员可设置 “您所请求的资源无法找到” 的个性页面</li><li>408 Request Timeout: 服务器等待客户端发送的请求时间过长，超时</li></ul></li><li>5xx：表示服务器的差错，如服务器失效无法完成请求 <ul><li>500 Internal Server Error: 服务器内部错误，无法完成请求</li><li>503 Service Unavailable: 由于超载或系统维护，服务器暂时的无法处理客户端的请求。延时的长度可包含在服务器的 Retry-After 头信息中</li><li>504 Gateway Timeout: 充当网关或代理的服务器，未及时从远端服务器获取请求</li></ul></li></ul><blockquote><p>更多状态码：<a href="http://www.runoob.com/http/http-status-codes.html" target="_blank" rel="noopener noreferrer">菜鸟教程 . HTTP状态码</a></p></blockquote><h4 id="其他协议" tabindex="-1"><a class="header-anchor" href="#其他协议"><span>其他协议</span></a></h4><ul><li>SMTP（Simple Main Transfer Protocol，简单邮件传输协议）是在 Internet 传输 Email 的标准，是一个相对简单的基于文本的协议。在其之上指定了一条消息的一个或多个接收者（在大多数情况下被确认是存在的），然后消息文本会被传输。可以很简单地通过 Telnet 程序来测试一个 SMTP 服务器。SMTP 使用 TCP 端口 25。</li><li>DHCP（Dynamic Host Configuration Protocol，动态主机设置协议）是一个局域网的网络协议，使用 UDP 协议工作，主要有两个用途： <ul><li>用于内部网络或网络服务供应商自动分配 IP 地址给用户</li><li>用于内部网络管理员作为对所有电脑作中央管理的手段</li></ul></li><li>SNMP（Simple Network Management Protocol，简单网络管理协议）构成了互联网工程工作小组（IETF，Internet Engineering Task Force）定义的 Internet 协议族的一部分。该协议能够支持网络管理系统，用以监测连接到网络上的设备是否有任何引起管理上关注的情况。</li></ul><p><a id="network-programming"></a></p><h2 id="socket编程" tabindex="-1"><a class="header-anchor" href="#socket编程"><span>Socket编程</span></a></h2><blockquote><p><a href="https://www.cnblogs.com/skynet/archive/2010/12/12/1903949.html" target="_blank" rel="noopener noreferrer">Linux Socket 编程（不限 Linux）</a></p></blockquote><figure><img src="'+m+`" alt="Socket 客户端服务器通讯" tabindex="0" loading="lazy"><figcaption>Socket 客户端服务器通讯</figcaption></figure><h3 id="socket-中的-read-、write-函数" tabindex="-1"><a class="header-anchor" href="#socket-中的-read-、write-函数"><span>Socket 中的 read()、write() 函数</span></a></h3><div class="language-cpp line-numbers-mode" data-highlighter="prismjs" data-ext="cpp"><pre><code><span class="line">ssize_t <span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span> size_t count<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">ssize_t <span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span> size_t count<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="read" tabindex="-1"><a class="header-anchor" href="#read"><span>read()</span></a></h4><ul><li>read 函数是负责从 fd 中读取内容。</li><li>当读成功时，read 返回实际所读的字节数。</li><li>如果返回的值是 0 表示已经读到文件的结束了，小于 0 表示出现了错误。</li><li>如果错误为 EINTR 说明读是由中断引起的；如果是 ECONNREST 表示网络连接出了问题。</li></ul><h4 id="write" tabindex="-1"><a class="header-anchor" href="#write"><span>write()</span></a></h4><ul><li>write 函数将 buf 中的 nbytes 字节内容写入文件描述符 fd。</li><li>成功时返回写的字节数。失败时返回 -1，并设置 errno 变量。</li><li>在网络程序中，当我们向套接字文件描述符写时有俩种可能。</li><li>（1）write 的返回值大于 0，表示写了部分或者是全部的数据。</li><li>（2）返回的值小于 0，此时出现了错误。</li><li>如果错误为 EINTR 表示在写的时候出现了中断错误；如果为 EPIPE 表示网络连接出现了问题（对方已经关闭了连接）。</li></ul><h3 id="socket-中-tcp-的三次握手建立连接" tabindex="-1"><a class="header-anchor" href="#socket-中-tcp-的三次握手建立连接"><span>Socket 中 TCP 的三次握手建立连接</span></a></h3><p>我们知道 TCP 建立连接要进行 “三次握手”，即交换三个分组。大致流程如下：</p><ol><li>客户端向服务器发送一个 SYN J</li><li>服务器向客户端响应一个 SYN K，并对 SYN J 进行确认 ACK J+1</li><li>客户端再想服务器发一个确认 ACK K+1</li></ol><p>只有就完了三次握手，但是这个三次握手发生在 Socket 的那几个函数中呢？请看下图：</p><figure><img src="`+k+'" alt="socket 中发送的 TCP 三次握手" tabindex="0" loading="lazy"><figcaption>socket 中发送的 TCP 三次握手</figcaption></figure><p>从图中可以看出：</p><ol><li>当客户端调用 connect 时，触发了连接请求，向服务器发送了 SYN J 包，这时 connect 进入阻塞状态；</li><li>服务器监听到连接请求，即收到 SYN J 包，调用 accept 函数接收请求向客户端发送 SYN K ，ACK J+1，这时 accept 进入阻塞状态；</li><li>客户端收到服务器的 SYN K ，ACK J+1 之后，这时 connect 返回，并对 SYN K 进行确认；</li><li>服务器收到 ACK K+1 时，accept 返回，至此三次握手完毕，连接建立。</li></ol><h3 id="socket-中-tcp-的四次握手释放连接" tabindex="-1"><a class="header-anchor" href="#socket-中-tcp-的四次握手释放连接"><span>Socket 中 TCP 的四次握手释放连接</span></a></h3><p>上面介绍了 socket 中 TCP 的三次握手建立过程，及其涉及的 socket 函数。现在我们介绍 socket 中的四次握手释放连接的过程，请看下图：</p><figure><img src="'+S+'" alt="socket 中发送的 TCP 四次握手" tabindex="0" loading="lazy"><figcaption>socket 中发送的 TCP 四次握手</figcaption></figure><p>图示过程如下：</p><ol><li>某个应用进程首先调用 close 主动关闭连接，这时 TCP 发送一个 FIN M；</li><li>另一端接收到 FIN M 之后，执行被动关闭，对这个 FIN 进行确认。它的接收也作为文件结束符传递给应用进程，因为 FIN 的接收意味着应用进程在相应的连接上再也接收不到额外数据；</li><li>一段时间之后，接收到文件结束符的应用进程调用 close 关闭它的 socket。这导致它的 TCP 也发送一个 FIN N；</li><li>接收到这个 FIN 的源发送端 TCP 对它进行确认。</li></ol><p>这样每个方向上都有一个 FIN 和 ACK。</p>',183)]))}const F=a(D,[["render",x],["__file","index.html.vue"]]),M=JSON.parse('{"path":"/Basic/network/","title":"计算机网络","lang":"en-US","frontmatter":{"date":"2020-11-30T22:26:35.000Z","tag":["Network"]},"git":{"createdTime":1606746395000,"updatedTime":1707212881000,"contributors":[{"name":"BanMing","username":"BanMing","email":"ban-ming@foxmail.com","commits":6,"url":"https://github.com/BanMing"},{"name":"wupeng","username":"wupeng","email":"wupeng_a2484@virtuos.com.cn","commits":2,"url":"https://github.com/wupeng"}]},"readingTime":{"minutes":21.63,"words":6489},"filePathRelative":"Basic/network/README.md","localizedDate":"November 30, 2020","excerpt":"\\n<blockquote>\\n<p>本节部分知识点来自《计算机网络（第 7 版）》</p>\\n</blockquote>\\n<p>计算机网络体系结构：</p>\\n<figure><figcaption>计算机网络体系结构</figcaption></figure>\\n<h2>各层作用及协议</h2>\\n<table>\\n<thead>\\n<tr>\\n<th>分层</th>\\n<th>作用</th>\\n<th>协议</th>\\n</tr>\\n</thead>\\n<tbody>\\n<tr>\\n<td>物理层</td>\\n<td>通过媒介传输比特，确定机械及电气规范（比特 Bit）</td>\\n<td>RJ45、CLOCK、IEEE802.3（中继器，集线器）</td>\\n</tr>\\n<tr>\\n<td>数据链路层</td>\\n<td>将比特组装成帧和点到点的传递（帧 Frame）</td>\\n<td>PPP、FR、HDLC、VLAN、MAC（网桥，交换机）</td>\\n</tr>\\n<tr>\\n<td>网络层</td>\\n<td>负责数据包从源到宿的传递和网际互连（包 Packet）</td>\\n<td>IP、ICMP、ARP、RARP、OSPF、IPX、RIP、IGRP（路由器）</td>\\n</tr>\\n<tr>\\n<td>运输层</td>\\n<td>提供端到端的可靠报文传递和错误恢复（ 段Segment）</td>\\n<td>TCP、UDP、SPX</td>\\n</tr>\\n<tr>\\n<td>会话层</td>\\n<td>建立、管理和终止会话（会话协议数据单元 SPDU）</td>\\n<td>NFS、SQL、NETBIOS、RPC</td>\\n</tr>\\n<tr>\\n<td>表示层</td>\\n<td>对数据进行翻译、加密和压缩（表示协议数据单元 PPDU）</td>\\n<td>JPEG、MPEG、ASII</td>\\n</tr>\\n<tr>\\n<td>应用层</td>\\n<td>允许访问OSI环境的手段（应用协议数据单元 APDU）</td>\\n<td>FTP、DNS、Telnet、SMTP、HTTP、WWW、NFS</td>\\n</tr>\\n</tbody>\\n</table>"}');export{F as comp,M as data};
