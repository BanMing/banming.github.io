import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{e as i,f as o,o as e}from"./app-B3vt1e3H.js";const a={};function r(l,t){return e(),i("div",null,t[0]||(t[0]=[o('<h1 id="animnotifystate-isnativebranchingpoint" tabindex="-1"><a class="header-anchor" href="#animnotifystate-isnativebranchingpoint"><span>AnimNotifyState IsNativeBranchingPoint</span></a></h1><p>我们来详细解释一下 Unreal Engine 中 <code>UAnimNotifyState::bIsNativeBranchingPoint</code> 这个属性的含义和作用。</p><h3 id="核心概念" tabindex="-1"><a class="header-anchor" href="#核心概念"><span>核心概念</span></a></h3><p>首先，<code>bIsNativeBranchingPoint</code> 是一个布尔值成员变量，定义在 <code>UAnimNotifyState</code> 类中。它的名字直译为“是原生分支点”。</p><p>要理解它，关键在于理解“<strong>分支点（Branching Point）</strong>”这个概念。</p><ol><li><p><strong>什么是分支点？</strong></p><ul><li>在动画蓝图中，<strong>分支点</strong>是一个特殊的时间点，引擎会在此处暂停动画的评估，等待游戏逻辑（如蓝图或C++代码）决定下一步该做什么。</li><li>这通常用于需要<strong>同步</strong>或需要根据游戏状态做出<strong>精确决策</strong>的情况。例如： <ul><li><strong>Root Motion 同步</strong>：确保角色的位移与动画帧完美对齐。</li><li><strong>事件响应</strong>：在动画的特定帧，等待一个外部事件（如玩家输入、网络消息）来决定是继续播放、跳转到另一个动画还是执行其他操作。</li><li><strong>复杂的动画过渡</strong>：在精确的时刻根据条件切换状态。</li></ul></li></ul></li><li><p><strong>原生（Native）的含义：</strong></p><ul><li>“原生”意味着这个功能是由引擎底层C++代码实现和驱动的，而不是在蓝图层级模拟的。它更高效、更精确。</li></ul></li></ol><h3 id="bisnativebranchingpoint-的作用" tabindex="-1"><a class="header-anchor" href="#bisnativebranchingpoint-的作用"><span><code>bIsNativeBranchingPoint</code> 的作用</span></a></h3><p>当你将一个 <code>AnimNotifyState</code> 子类（注意：是 <strong>NotifyState</strong>，而不是普通的 <code>AnimNotify</code>）的 <code>bIsNativeBranchingPoint</code> 属性设置为 <code>true</code> 时，你是在告诉引擎：</p><p><strong>“请将我这个 NotifyState 的起始时刻（<code>NotifyBegin</code> 被调用的那一刻）当作一个原生的分支点来处理。”</strong></p><h4 id="设置为-true-时会发生什么" tabindex="-1"><a class="header-anchor" href="#设置为-true-时会发生什么"><span>设置为 <code>true</code> 时会发生什么：</span></a></h4><ol><li><strong>动画暂停</strong>：当动画播放到你的 NotifyState 开始时，引擎会<strong>暂停动画序列的更新</strong>。</li><li><strong>等待决策</strong>：动画线程会挂起，等待游戏线程（你的游戏逻辑）给出指令。</li><li><strong>触发通知</strong>：在你的游戏线程中，<code>NotifyBegin</code> 事件会被调用。因为动画已经暂停，你可以在这个事件里安全地执行逻辑并决定下一步的动画行为（例如，使用 <code>Montage_JumpToSection</code>）。</li><li><strong>继续播放</strong>：一旦你的游戏逻辑执行完毕（例如，完成了跳转），引擎会从分支点继续动画的评估和播放。</li></ol><h4 id="典型工作流程-以蒙太奇为例" tabindex="-1"><a class="header-anchor" href="#典型工作流程-以蒙太奇为例"><span>典型工作流程（以蒙太奇为例）：</span></a></h4><ol><li>你的角色正在播放一个攻击蒙太奇。</li><li>蒙太奇中包含一个 <code>AnimNotifyState</code>，其 <code>bIsNativeBranchingPoint = true</code>，持续时间覆盖了攻击动作的“可取消窗口”。</li><li>动画播放到该 NotifyState 的开始帧（分支点）时，<strong>动画暂停</strong>。</li><li><code>NotifyBegin</code> 被调用。在这个函数里，你可能会检查玩家是否按下了闪避键。</li><li><strong>情况A</strong>：如果按下了闪避键，你调用 <code>Montage_JumpToSection(“Roll”)</code>。引擎会立即跳转到指定的“Roll”片段，并从新的动画继续播放。</li><li><strong>情况B</strong>：如果什么都没发生，动画会从暂停的地方继续正常播放，直到 NotifyState 结束。</li></ol><h3 id="何时使用-bisnativebranchingpoint" tabindex="-1"><a class="header-anchor" href="#何时使用-bisnativebranchingpoint"><span>何时使用 <code>bIsNativeBranchingPoint</code>？</span></a></h3><p>你应该在以下情况下将其设置为 <code>true</code>：</p><ul><li><strong>需要帧精确的同步</strong>：尤其是与 Root Motion 相关的操作，你必须确保位移和动画帧绝对匹配。</li><li><strong>需要在通知中执行可能改变动画状态的逻辑</strong>：比如在通知里跳转蒙太奇章节、停止蒙太奇等。使用分支点可以保证这些操作在动画评估前发生，避免一帧的延迟或不一致。</li><li><strong>实现可中断的动画窗口</strong>：如上方的攻击取消为例，这是最常见的用法之一。</li></ul><h3 id="何时不需要-设置为-false-或使用普通-notify" tabindex="-1"><a class="header-anchor" href="#何时不需要-设置为-false-或使用普通-notify"><span>何时不需要（设置为 <code>false</code> 或使用普通 Notify）？</span></a></h3><ul><li><strong>普通事件</strong>：如果你只是播放一个声音、生成粒子效果或设置一个变量，这些操作不会改变当前的动画播放状态，完全不需要分支点。使用普通的 <code>AnimNotify</code> 或 <code>bIsNativeBranchingPoint = false</code> 的 <code>AnimNotifyState</code> 即可。</li><li><strong>性能考虑</strong>：分支点需要暂停和恢复动画线程，有一定的性能开销。不要滥用，只在必要时使用。</li></ul><h3 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h3><table><thead><tr><th style="text-align:left;">特性</th><th style="text-align:left;"><code>bIsNativeBranchingPoint = true</code></th><th style="text-align:left;">普通 Notify 或 <code>bIsNativeBranchingPoint = false</code></th></tr></thead><tbody><tr><td style="text-align:left;"><strong>目的</strong></td><td style="text-align:left;">创建同步点，用于可能改变动画状态的决策</td><td style="text-align:left;">触发简单的、不中断动画的事件</td></tr><tr><td style="text-align:left;"><strong>行为</strong></td><td style="text-align:left;"><strong>暂停</strong>动画线程，等待游戏逻辑决策</td><td style="text-align:left;"><strong>不暂停</strong>动画，与动画并行执行</td></tr><tr><td style="text-align:left;"><strong>性能</strong></td><td style="text-align:left;">开销稍大</td><td style="text-align:left;">开销小</td></tr><tr><td style="text-align:left;"><strong>使用场景</strong></td><td style="text-align:left;">动画取消、Root Motion 同步、帧精确跳转</td><td style="text-align:left;">播放音效、生成特效、标记事件</td></tr></tbody></table><p><strong>简单来说：如果你需要在动画的某一精确帧根据游戏状态来决定接下来播放什么动画，就应该使用一个将 <code>bIsNativeBranchingPoint</code> 设置为 <code>true</code> 的 <code>AnimNotifyState</code>。如果只是触发一个简单事件，则不需要它。</strong></p>',21)]))}const d=n(a,[["render",r],["__file","NativeBranchingPoint.html.vue"]]),c=JSON.parse('{"path":"/GameEngine/Unreal/animation/NativeBranchingPoint.html","title":"AnimNotifyState IsNativeBranchingPoint","lang":"en-US","frontmatter":{"date":"2025-09-08T18:57:03.000Z","tag":["Unreal Engine","Animation"]},"git":{"createdTime":1758212578000,"updatedTime":1758212578000,"contributors":[{"name":"BanMing","username":"BanMing","email":"ban-ming@foxmail.com","commits":1,"url":"https://github.com/BanMing"}]},"readingTime":{"minutes":3.97,"words":1190},"filePathRelative":"GameEngine/Unreal/animation/NativeBranchingPoint.md","localizedDate":"September 8, 2025","excerpt":"\\n<p>我们来详细解释一下 Unreal Engine 中 <code>UAnimNotifyState::bIsNativeBranchingPoint</code> 这个属性的含义和作用。</p>\\n<h3>核心概念</h3>\\n<p>首先，<code>bIsNativeBranchingPoint</code> 是一个布尔值成员变量，定义在 <code>UAnimNotifyState</code> 类中。它的名字直译为“是原生分支点”。</p>\\n<p>要理解它，关键在于理解“<strong>分支点（Branching Point）</strong>”这个概念。</p>\\n<ol>\\n<li>\\n<p><strong>什么是分支点？</strong></p>\\n<ul>\\n<li>在动画蓝图中，<strong>分支点</strong>是一个特殊的时间点，引擎会在此处暂停动画的评估，等待游戏逻辑（如蓝图或C++代码）决定下一步该做什么。</li>\\n<li>这通常用于需要<strong>同步</strong>或需要根据游戏状态做出<strong>精确决策</strong>的情况。例如：\\n<ul>\\n<li><strong>Root Motion 同步</strong>：确保角色的位移与动画帧完美对齐。</li>\\n<li><strong>事件响应</strong>：在动画的特定帧，等待一个外部事件（如玩家输入、网络消息）来决定是继续播放、跳转到另一个动画还是执行其他操作。</li>\\n<li><strong>复杂的动画过渡</strong>：在精确的时刻根据条件切换状态。</li>\\n</ul>\\n</li>\\n</ul>\\n</li>\\n<li>\\n<p><strong>原生（Native）的含义：</strong></p>\\n<ul>\\n<li>“原生”意味着这个功能是由引擎底层C++代码实现和驱动的，而不是在蓝图层级模拟的。它更高效、更精确。</li>\\n</ul>\\n</li>\\n</ol>"}');export{d as comp,c as data};
